{"createdAt":"2025-08-03T13:06:32.238Z","updatedAt":"2025-08-28T17:07:16.962Z","id":"Ps6Wn2rH2JJ13Sb1","name":"zalo test","active":false,"isArchived":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"hass-zalo-bot","responseMode":"lastNode","options":{}},"name":"Webhook","id":"27624e56-58e5-47f1-a256-a58aec7c9a86","typeVersion":1,"position":[16,32],"type":"n8n-nodes-base.webhook","webhookId":"a0bd7c12-569b-42dc-8baa-19f74b9de7ca"},{"parameters":{"resource":"service","operation":"call","domain":"zalo_bot","service":"send_message","serviceAttributes":{"attributes":[{"name":"message","value":"={{ $json.message }}"},{"name":"thread_id","value":"={{ $('to json').item.json.rawData.threadId }}"},{"name":"account_selection","value":"=+84947762285"},{"name":"type","value":"0"}]}},"type":"n8n-nodes-base.homeAssistant","typeVersion":1,"position":[2608,-176],"id":"b4ce7346-2e1d-4513-88c4-f05ba34329de","name":"Call a service","credentials":{"homeAssistantApi":{"id":"1lV5PEu2rtjuQlDB","name":"Home Assistant account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"59d4e8fc-8cfa-44a7-93b5-52a792f7a335","leftValue":"={{ $json.msgType }}","rightValue":"=webchat","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[576,96],"id":"fda10db1-0b43-43fa-8bcf-9d24d52f13cb","name":"If text"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"c6ec428a-2e31-43e8-b824-61abcf52adcf","leftValue":"={{ $json.msgType }}","rightValue":"chat.voice","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[576,272],"id":"2ff56ca9-f8ec-4789-8400-c3994435fffd","name":"If voice"},{"parameters":{"jsCode":"const items = $input.all();\nlet inputData = items[0].json;\n\n// Láº¥y ná»™i dung cáº§n xá»­ lÃ½\nlet msg = inputData.output;\n\n// Loáº¡i bá» pháº§n <think>...</think>\nmsg = msg.replace(/<think>[\\s\\S]*?<\\/think>/gi, '');\n\n// XÃ³a cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t: backtick vÃ  dáº¥u sao\nmsg = msg.replace(/`/g, '').replace(/\\*/g, '');\n\n// Loáº¡i bá» khoáº£ng tráº¯ng thá»«a á»Ÿ Ä‘áº§u vÃ  cuá»‘i\nmsg = msg.trim();\n\n// PhÃ¢n tÃ¡ch tin nháº¯n dÃ i\nconst maxLen = 3000;\nlet messages = [];\n\nfor (let i = 0; i < msg.length; i += maxLen) {\n  let part = msg.substring(i, i + maxLen);\n  messages.push({ \n    json: { \n      message: part, \n      quote: { thumb: \"\" } \n    } \n  });\n}\n\nreturn messages.length ? messages : [{ \n  json: { \n    message: \"KhÃ´ng cÃ³ thÃ´ng tin Ä‘á»ƒ hiá»ƒn thá»‹\", \n    quote: { thumb: \"\" } \n  } \n}];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2208,-352],"id":"868cd623-4d14-4f9e-a799-1435370adf02","name":"maxLen"},{"parameters":{"jsCode":"return items.map(item => {\n  const text = item.json.content.parts?.[0]?.text || '';\n  return {\n    json: {\n      content: text\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1024,256],"id":"1125abbf-6c49-4e80-9695-a2dabaee0e1a","name":"Code"},{"parameters":{"resource":"audio","modelId":{"__rl":true,"value":"models/gemini-2.0-flash-lite","mode":"list","cachedResultName":"models/gemini-2.0-flash-lite"},"audioUrls":"={{ $json.content.href }}","options":{}},"type":"@n8n/n8n-nodes-langchain.googleGemini","typeVersion":1,"position":[848,256],"id":"149910fd-b3fd-4e70-83aa-71e92d27ea2b","name":"stt","credentials":{"googlePalmApi":{"id":"BmSJpQbzqh1rnp4z","name":"NguyenViet"}}},{"parameters":{"sseEndpoint":"http://192.168.1.220:5678/mcp/google"},"type":"@n8n/n8n-nodes-langchain.mcpClientTool","typeVersion":1,"position":[2208,272],"id":"d4e54d9a-6a68-48d5-abf4-b73e93672b72","name":"google","disabled":true},{"parameters":{"description":"Use this tool to download files, documents","workflowId":{"__rl":true,"value":"T1gzDhDncq21FOJB","mode":"list","cachedResultName":"Download"},"workflowInputs":{"mappingMode":"defineBelow","value":{"idzalo":"{{ $('to json').item.json.rawData.threadId }}","idfile":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('idfile', `- idfile: ID of file, document`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"idfile","displayName":"idfile","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true},{"id":"idzalo","displayName":"idzalo","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[2464,432],"id":"28ec2660-2d27-43cd-8e90-2d4104fddaf1","name":"download","disabled":true},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.3,"position":[1312,-656],"id":"a7db67ac-52b7-4b51-b3ce-0b76b283878c","name":"When chat message received","webhookId":"37e464be-d1a0-4011-abd1-539c54c1dbdd"},{"parameters":{"jsCode":"// Láº¥y dá»¯ liá»‡u tá»« webhook\nconst webhookData = $input.item.json;\n\n// Láº¥y chuá»—i message\nconst messageString = webhookData.originalMessage || webhookData.body.message;\n\n// Parse chuá»—i message thÃ nh object\nlet messageData;\ntry {\n  // Xá»­ lÃ½ cÃ¡c giÃ¡ trá»‹ Python khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i JSON\n  let jsonCompatible = messageString\n    .replace(/'/g, '\"')          // Thay tháº¿ dáº¥u nhÃ¡y Ä‘Æ¡n báº±ng dáº¥u nhÃ¡y kÃ©p\n    .replace(/False/g, 'false')  // Thay tháº¿ False cá»§a Python thÃ nh false cá»§a JSON\n    .replace(/True/g, 'true')    // Thay tháº¿ True cá»§a Python thÃ nh true cá»§a JSON\n    .replace(/None/g, 'null');   // Thay tháº¿ None cá»§a Python thÃ nh null cá»§a JSON\n  \n  // Xá»­ lÃ½ cÃ¡c chuá»—i JSON lá»“ng nhau Ä‘Ã£ Ä‘Æ°á»£c escape\n  jsonCompatible = jsonCompatible.replace(/\"{/g, '{').replace(/}\"/g, '}');\n  \n  // Parse chuá»—i thÃ nh object\n  messageData = JSON.parse(jsonCompatible);\n} catch (error) {\n  // Náº¿u váº«n khÃ´ng parse Ä‘Æ°á»£c, thá»­ cÃ¡ch khÃ¡c\n  try {\n    // ÄÃ´i khi chuá»—i cÃ³ thá»ƒ chá»©a cÃ¡c kÃ½ tá»± escape khÃ´ng há»£p lá»‡\n    const evalString = messageString\n      .replace(/'/g, '\"')\n      .replace(/False/g, 'false')\n      .replace(/True/g, 'true')\n      .replace(/None/g, 'null');\n    \n    // Sá»­ dá»¥ng eval má»™t cÃ¡ch an toÃ n Ä‘á»ƒ parse chuá»—i\n    messageData = JSON.parse(evalString);\n  } catch (err) {\n    // Náº¿u khÃ´ng parse Ä‘Æ°á»£c, tráº£ vá» lá»—i chi tiáº¿t\n    return {\n      json: {\n        error: \"KhÃ´ng thá»ƒ parse dá»¯ liá»‡u message\",\n        originalMessage: messageString,\n        errorDetails: error.message,\n        secondAttemptError: err.message\n      }\n    };\n  }\n}\n\n// Táº¡o object káº¿t quáº£ vá»›i cÃ¡c trÆ°á»ng chÃ­nh\nconst result = {\n  // ThÃ´ng tin chung\n  type: messageData.type,\n  isSelf: messageData.isSelf,\n  threadId: messageData.threadId,\n  accountId: messageData._accountId,\n  \n  // ThÃ´ng tin tin nháº¯n\n  actionId: messageData.data?.actionId,\n  msgId: messageData.data?.msgId,\n  cliMsgId: messageData.data?.cliMsgId,\n  msgType: messageData.data?.msgType,\n  \n  // ThÃ´ng tin ngÆ°á»i gá»­i/nháº­n\n  uidFrom: messageData.data?.uidFrom,\n  idTo: messageData.data?.idTo,\n  dName: messageData.data?.dName,\n  \n  // Ná»™i dung tin nháº¯n\n  content: messageData.data?.content,\n  timestamp: messageData.data?.ts,\n  status: messageData.data?.status,\n  \n  // ThÃ´ng tin trÃ­ch dáº«n náº¿u cÃ³\n  quote: messageData.data?.quote ? {\n    ownerId: messageData.data.quote.ownerId,\n    message: messageData.data.quote.msg,\n    timestamp: messageData.data.quote.ts,\n    fromName: messageData.data.quote.fromD\n  } : null,\n  \n  // ThÃ´ng tin mentions náº¿u cÃ³\n  mentions: messageData.data?.mentions || [],\n  \n  // Dá»¯ liá»‡u gá»‘c Ä‘á»ƒ tham kháº£o\n  rawData: messageData\n};\n\n// Tráº£ vá» káº¿t quáº£\nreturn {\n  json: result\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[304,48],"id":"d240e346-21a6-47bd-a85f-317badd79453","name":"to json"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('to json').item.json.threadId }}"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[1616,256],"id":"88895d8d-973b-4744-88ec-9eed9a78cd47","name":"Postgres Chat Memory","credentials":{"postgres":{"id":"vDBK6XLC0TBpoMww","name":"Postgres account"}}},{"parameters":{"description":"Use this tool to create an image","workflowId":{"__rl":true,"value":"MkjYDmFAbCalYYca","mode":"list","cachedResultName":"taoanh"},"workflowInputs":{"mappingMode":"defineBelow","value":{"prompt":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('prompt', `prompt: yÃªu cáº§u táº¡o áº£nh`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"prompt","displayName":"prompt","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[2496,256],"id":"ed72c81d-714a-4e24-a3ea-592624713d21","name":"taoanh","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"6af2676d-1c0b-4a31-97a1-f28ce71596a2","leftValue":"={{ $json.msgType }}","rightValue":"chat.location.new","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[576,-64],"id":"db289222-40be-4ed2-9745-fe194d8e6bc0","name":"If"},{"parameters":{"assignments":{"assignments":[{"id":"626261bb-ae79-4fac-a875-cb37dbce9f75","name":"thá»i tiáº¿t","value":"=thá»i tiáº¿t {{ $json.content.description }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[880,-96],"id":"4c266bd1-3527-468e-90cb-bbd1cbaffad3","name":"Edit Fields"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d35f523e-09af-4a9c-a866-d123a96f790b","leftValue":"={{ $json.msgType }}","rightValue":"chat.photo","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"bca28b7b-6b1e-490b-960d-ad4a52146fad","leftValue":"={{ $json.uidFrom }}","rightValue":"6643404425553198601","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[560,-256],"id":"bcb41d01-e033-4bb4-a233-f34843b9a03f","name":"If img1"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"models/gemini-2.5-flash","mode":"list","cachedResultName":"models/gemini-2.5-flash"},"text":"Chá»‰ trÃ­ch xuáº¥t Ä‘Ãºng vÃ  Ä‘áº§y Ä‘á»§ thÃ´ng tin theo má»™t trong ba nhÃ³m sau (khÃ´ng thÃªm dá»¯ liá»‡u ngoÃ i yÃªu cáº§u):\n\nThÃ´ng tin phÆ°Æ¡ng tiá»‡n:\nLoáº¡i xe: Ã´ tÃ´, xe mÃ¡y hoáº·c xe Ä‘iá»‡n\nBiá»ƒn sá»‘ xe\n\nThÃ´ng tin vÃ© sá»‘:\nKhu vá»±c (miá»n Báº¯c, miá»n Trung, miá»n Nam hoáº·c tÃªn tá»‰nh/thÃ nh)\nDÃ£y sá»‘ vÃ©\nNgÃ y má»Ÿ thÆ°á»Ÿng\nThÃ´ng tin tem kiá»ƒm Ä‘á»‹nh:\nMÃ£/ThÃ´ng tin tem kiá»ƒm Ä‘á»‹nh\nNáº¿u khÃ´ng cÃ³ thÃ´ng tin khá»›p vá»›i cÃ¡c thÃ´ng tin trÃªn thÃ¬ mÃ´ táº£ 1-2 cÃ¢u vá» bá»©c áº£nh","imageUrls":"={{ $json.content.href }}","options":{}},"type":"@n8n/n8n-nodes-langchain.googleGemini","typeVersion":1,"position":[976,-368],"id":"da2918f2-dc46-4c48-9ec5-051e855dea88","name":"Analyze image","credentials":{"googlePalmApi":{"id":"BmSJpQbzqh1rnp4z","name":"NguyenViet"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d35f523e-09af-4a9c-a866-d123a96f790b","leftValue":"={{ $json.msgType }}","rightValue":"share.file","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"bca28b7b-6b1e-490b-960d-ad4a52146fad","leftValue":"={{ $json.uidFrom }}","rightValue":"6643404425553198601","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[560,-416],"id":"6224aca9-7007-4d94-920d-a75daf5819a9","name":"If img"},{"parameters":{"operation":"deleteTable","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"n8n_chat_histories","mode":"list","cachedResultName":"n8n_chat_histories"},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1760,1568],"id":"9c42acfc-6061-438e-b20d-9bd63153faee","name":"Delete table or rows","credentials":{"postgres":{"id":"vDBK6XLC0TBpoMww","name":"Postgres account"}}},{"parameters":{"sseEndpoint":"http://192.168.1.220:5678/mcp/tracuu"},"type":"@n8n/n8n-nodes-langchain.mcpClientTool","typeVersion":1,"position":[2336,256],"id":"f2921e4c-500f-49b1-b58d-9face94e562f","name":"Lookup","disabled":true},{"parameters":{"operation":"executeQuery","query":"SELECT * \nFROM vnnew\nLIMIT 10;\n","options":{}},"type":"n8n-nodes-base.postgresTool","typeVersion":2.6,"position":[2656,224],"id":"9f5c4af3-fa20-4af3-94ad-9e6a98e13478","name":"vnnew","credentials":{"postgres":{"id":"vDBK6XLC0TBpoMww","name":"Postgres account"}},"disabled":true},{"parameters":{"description":"Sá»­ dá»¥ng cÃ´ng cá»¥ nÃ y TÃ¬m gháº¹ theo tá»‰nh, quáº­n huyá»‡n, giÃ¡, nhÃ¢n viÃªn.","workflowId":{"__rl":true,"value":"prLlQTFWp6skvdWf","mode":"list","cachedResultName":"ghe"},"workflowInputs":{"mappingMode":"defineBelow","value":{"tinh":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('tinh', `province\nIf no information, leave it as 0`, 'string') }}","huyen":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('huyen', `district\nIf no information, leave it as 0`, 'string') }}","gia":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('gia', `price\nIf no information, leave it as 0`, 'string') }}","nhanvien":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('nhanvien', `person\nIf no information, leave it as 0`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"tinh","displayName":"tinh","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true},{"id":"huyen","displayName":"huyen","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true},{"id":"gia","displayName":"gia","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true},{"id":"nhanvien","displayName":"nhanvien","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[2832,224],"id":"3dc8a5c2-f989-4443-9ab4-1819d1e61360","name":"masager","disabled":true},{"parameters":{"method":"POST","url":"http://192.168.1.220:8000/generate","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"prompt","value":"=tÃ´i cáº§n táº¡o 1 áº£nh vá»›i yÃªu cáº§u ğ‘€ğ‘œÌ£Ì‚ğ‘¡ ğ‘ğ‘¢Ì›Ìğ‘ ğ‘Ì‰ğ‘›â„ ğ‘â„ğ‘œğ‘¡ğ‘œğ‘Ÿğ‘’ğ‘ğ‘™ğ‘–ğ‘ ğ‘¡ğ‘–ğ‘ ğ‘â„ğ‘Ì‚ğ‘› ğ‘‘ğ‘¢ğ‘›ğ‘” ğ‘¡ğ‘œğ‘Ì€ğ‘› ğ‘¡â„ğ‘Ì‚ğ‘› ğ‘ğ‘¢Ì‰ğ‘ ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘›ğ‘”Æ°ğ‘œÌ›Ì€ğ‘– ğ‘â„ğ‘¢Ì£ ğ‘›ğ‘¢Ì›Ìƒ ğ¶â„ğ‘Ì‚ğ‘¢ ğ´Ì ğ‘¡ğ‘Ÿğ‘’Ì‰ ğ‘¡ğ‘¢ğ‘œÌ‚Ì‰ğ‘–, ğ‘ğ‘¢ğ‘¦ğ‘’Ì‚Ìğ‘› ğ‘Ÿğ‘¢Ìƒ, ğ‘˜â„ğ‘œğ‘Ì‰ğ‘›ğ‘” 20-22 ğ‘¡ğ‘¢ğ‘œÌ‚Ì‰ğ‘–, ğ‘£ğ‘œÌ›Ìğ‘– ğ‘£ğ‘œÌ›Ìğ‘– ğ‘™ğ‘Ì€ğ‘› ğ‘‘ğ‘ ğ‘¡ğ‘Ÿğ‘Ì†Ìğ‘›ğ‘” â„ğ‘œÌ‚Ì€ğ‘›ğ‘” ğ‘šğ‘–Ì£ğ‘› ğ‘šğ‘Ì€ğ‘›ğ‘” ğ‘šğ‘Ìğ‘– ğ‘¡ğ‘œÌğ‘ Ä‘ğ‘’ğ‘› ğ‘‘ğ‘Ì€ğ‘–. ğ¶ğ‘œÌ‚ ğ‘Ì‚Ìğ‘¦ Ä‘ğ‘ğ‘›ğ‘” Ä‘ğ‘¢Ì›Ìğ‘›ğ‘” ğ‘œÌ›Ì‰ ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘˜â„ğ‘¢ ğ‘£ğ‘¢Ì›Ì£ğ‘ ğ‘Ÿğ‘¢Ì›Ì‰ğ‘ ğ‘¥ğ‘’ ğ‘›ğ‘”ğ‘œğ‘Ì€ğ‘– ğ‘¡ğ‘Ÿğ‘œÌ›Ì€ğ‘–, ğ‘›ğ‘”ğ‘Ì‚Ì‰ğ‘›ğ‘” Ä‘ğ‘Ì‚Ì€ğ‘¢ ğ‘™ğ‘’Ì‚ğ‘›, ğ‘›â„ğ‘Ì†Ìğ‘š ğ‘šğ‘Ì†Ìğ‘¡ ğ‘£ğ‘Ì€ â„ğ‘’Ì ğ‘šğ‘œÌ‚ğ‘–, ğ‘¡ğ‘Ì£Ì‚ğ‘› â„Æ°ğ‘œÌ›Ì‰ğ‘›ğ‘” ğ‘›â„ğ‘¢Ì›Ìƒğ‘›ğ‘” ğ‘”ğ‘–ğ‘œÌ£ğ‘¡ ğ‘›Æ°ğ‘œÌ›Ìğ‘ ğ‘šğ‘Ìğ‘¡ ğ‘™ğ‘Ì£ğ‘›â„ ğ‘â„ğ‘Ì‰ğ‘¦ ğ‘¡ğ‘¢Ì›Ì€ ğ‘¡ğ‘œÌğ‘ Æ°ğ‘œÌ›Ìğ‘¡ ğ‘ ğ‘¢Ìƒğ‘›ğ‘” ğ‘¥ğ‘¢ğ‘œÌ‚Ìğ‘›ğ‘” ğ‘šğ‘Ì£Ì†ğ‘¡ ğ‘£ğ‘Ì€ ğ‘›ğ‘”ğ‘¢Ì›Ì£ğ‘, ğ‘¡ğ‘Ì£ğ‘œ â„ğ‘–á»‡ğ‘¢ ğ‘¢Ì›Ìğ‘›ğ‘” ğ‘”ğ‘–ğ‘œÌ£ğ‘¡ ğ‘›Æ°ğ‘œÌ›Ìğ‘ ğ‘™ğ‘Ì‚Ìğ‘ ğ‘™ğ‘Ìğ‘›â„ ğ‘£ğ‘Ì€ ğ‘ğ‘œÌ£ğ‘¡ ğ‘¥ğ‘Ì€ ğ‘â„ğ‘œÌ€ğ‘›ğ‘” ğ‘ğ‘Ìğ‘š ğ‘¡ğ‘Ÿğ‘’Ì‚ğ‘› ğ‘‘ğ‘. ğ¶ğ‘œÌ‚ ğ‘Ì‚Ìğ‘¦ ğ‘šğ‘Ì£Ì†ğ‘ ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘â„ğ‘–ğ‘’Ì‚Ìğ‘ ğ‘Ìğ‘œ ğ‘¡â„ğ‘¢ğ‘› ğ‘¡ğ‘Ÿğ‘Ì†Ìğ‘›ğ‘” ğ‘ğ‘œÌ‚Ì‰ ğ‘â„ğ‘¢Ì›Ìƒ ğ‘‰ ğ‘ ğ‘Ì‚ğ‘¢ Æ°ğ‘œÌ›Ìğ‘¡ ğ‘ ğ‘¢Ìƒğ‘›ğ‘” ğ‘£ğ‘Ì€ ğ‘ğ‘Ìğ‘š ğ‘ ğ‘Ìğ‘¡ ğ‘ğ‘œÌ› ğ‘¡â„ğ‘’Ì‚Ì‰, â„ğ‘œÌ›ğ‘– ğ‘¡ğ‘Ÿğ‘œğ‘›ğ‘” ğ‘ ğ‘¢ğ‘œÌ‚Ìğ‘¡ Ä‘ğ‘’Ì‚Ì‰ ğ‘™ğ‘œÌ£Ì‚ Ä‘Æ°ğ‘œÌ›Ì€ğ‘›ğ‘” ğ‘›ğ‘’Ìğ‘¡ ğ‘ğ‘œÌ› ğ‘¡â„ğ‘’Ì‚Ì‰, ğ‘ğ‘¢Ì€ğ‘›ğ‘” ğ‘ğ‘¢ğ‘Ì‚Ì€ğ‘› ğ‘™ğ‘œÌğ‘¡ ğ‘ğ‘–ğ‘˜ğ‘–ğ‘›ğ‘– ğ‘šğ‘Ì€ğ‘¢ Ä‘ğ‘’ğ‘› ğ‘ğ‘Ì£ğ‘ ğ‘¡â„ğ‘Ì‚Ìğ‘. ğ¶ğ‘œÌ‚ ğ‘Ì‚Ìğ‘¦ Ä‘ğ‘ğ‘›ğ‘” ğ‘‘ğ‘¢Ì€ğ‘›ğ‘” ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘šğ‘–ğ‘’Ì‚Ìğ‘›ğ‘” ğ‘ğ‘œÌ£ğ‘¡ ğ‘ğ‘–ğ‘’Ì‚Ì‰ğ‘› ğ‘šğ‘Ì€ğ‘¢ ğ‘¥ğ‘ğ‘›â„ Ä‘ğ‘Ì£Ì‚ğ‘š Ä‘ğ‘’Ì‚Ì‰ ğ‘™ğ‘ğ‘¢ ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘â„ğ‘–ğ‘’Ì‚Ìğ‘ ğ‘¥ğ‘’ ğ‘‘ğ‘’ğ‘ğ‘¤ğ‘œğ‘œ ğ‘šğ‘ğ‘¡ğ‘–ğ‘§ 2007 ğ‘šğ‘Ì€ğ‘¢ Ä‘ğ‘œÌ‰ ğ‘ğ‘–ğ‘’Ì‚Ì‰ğ‘› ğ‘ ğ‘œÌ‚Ì 64ğ´-088.72. ğ‘ğ‘’Ì‚Ì€ğ‘› ğ‘™ğ‘Ì€ ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘ğ‘¢Ì›Ìğ‘ ğ‘¡Æ°ğ‘œÌ›Ì€ğ‘›ğ‘” ğ‘šğ‘Ì€ğ‘¢ ğ‘ğ‘’/ğ‘¥ğ‘Ìğ‘š ğ‘›â„ğ‘Ì£ğ‘¡ ğ‘˜ğ‘’Ì‚Ìğ‘¡ ğ‘ğ‘Ì‚Ìğ‘¢ ğ‘¡â„ğ‘œÌ‚ ğ‘£ğ‘Ì€ ğ‘â„ğ‘Ì‚Ì€ğ‘› ğ‘šğ‘Ìğ‘– ğ‘â„ğ‘’ ğ‘˜ğ‘–ğ‘š ğ‘™ğ‘œğ‘Ì£ğ‘– ğ‘šğ‘Ì€ğ‘¢ ğ‘¡ğ‘œÌ‚Ìğ‘– ğ‘œÌ›Ì‰ ğ‘â„ğ‘–Ìğ‘ ğ‘¡ğ‘Ÿğ‘’Ì‚ğ‘› ğ‘ğ‘¢Ì€ğ‘›ğ‘” ğ‘ğ‘¢Ì‰ğ‘ ğ‘˜â„ğ‘¢ğ‘›ğ‘” â„ğ‘–Ì€ğ‘›â„, ğ‘£ğ‘œÌ›Ìğ‘– ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘â„ğ‘–ğ‘’Ì‚Ìğ‘ ğ‘¥ğ‘œÌ‚ ğ‘›â„ğ‘¢Ì›Ì£ğ‘ ğ‘šğ‘Ì€ğ‘¢ ğ‘¥ğ‘Ìğ‘š ğ‘£ğ‘Ì€ ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘‘ğ‘Ì‚ğ‘¦ ğ‘¡Æ°ğ‘œÌ›Ìğ‘– ğ‘šğ‘Ì€ğ‘¢ ğ‘¥ğ‘ğ‘›â„ ğ‘™ğ‘Ì ğ‘ğ‘Ì‚ğ‘¦ ğ‘ğ‘¢ğ‘œÌ£Ì‚ğ‘› ğ‘™ğ‘Ì£ğ‘– ğ‘¡ğ‘Ÿğ‘’ğ‘œ ğ‘¡ğ‘Ÿğ‘’Ì‚ğ‘› ğ‘¡Æ°ğ‘œÌ›Ì€ğ‘›ğ‘” ğ‘œÌ›Ì‰ ğ‘¥ğ‘ ğ‘ğ‘’Ì‚ğ‘› ğ‘¡ğ‘Ÿğ‘Ìğ‘–. ğ´Ìğ‘›â„ ğ‘ ğ‘Ìğ‘›ğ‘” ğ‘¡ğ‘¢Ì›Ì£ ğ‘›â„ğ‘–ğ‘’Ì‚ğ‘› ğ‘šğ‘Ì£ğ‘›â„ ğ‘šğ‘’Ìƒ ğ‘¡ğ‘¢Ì›Ì€ ğ‘â„ğ‘–Ìğ‘ ğ‘ ğ‘ğ‘¢ ğ‘£ğ‘Ì€ ğ‘ğ‘’Ì‚ğ‘› ğ‘â„ğ‘Ì‰ğ‘– ğ‘¡ğ‘Ì£ğ‘œ â„ğ‘–á»‡ğ‘¢ ğ‘¢Ì›Ìğ‘›ğ‘” ğ‘£ğ‘–ğ‘’Ì‚Ì€ğ‘› ğ‘ ğ‘Ìğ‘›ğ‘” (ğ‘Ÿğ‘–ğ‘š ğ‘™ğ‘–ğ‘”â„ğ‘¡) ğ‘Ÿğ‘¢Ì›Ì£ğ‘ ğ‘Ÿğ‘œÌ›Ìƒ ğ‘ğ‘¢ğ‘ğ‘›â„ ğ‘›ğ‘”Æ°ğ‘œÌ›Ì€ğ‘– ğ‘ğ‘œÌ‚ ğ‘Ì‚Ìğ‘¦, ğ‘™ğ‘Ì€ğ‘š ğ‘›ğ‘œÌ‚Ì‰ğ‘– ğ‘ğ‘Ì£Ì‚ğ‘¡ Ä‘Æ°ğ‘œÌ›Ì€ğ‘›ğ‘” ğ‘›ğ‘’Ìğ‘¡ ğ‘ğ‘œÌ› ğ‘¡â„ğ‘’Ì‚Ì‰ ğ‘£ğ‘Ì€ ğ‘›â„ğ‘¢Ì›Ìƒğ‘›ğ‘” ğ‘”ğ‘–ğ‘œÌ£ğ‘¡ ğ‘›Æ°ğ‘œÌ›Ìğ‘, Ä‘ğ‘œÌ‚Ì€ğ‘›ğ‘” ğ‘¡â„ğ‘œÌ›Ì€ğ‘– ğ‘¡ğ‘Ì£ğ‘œ ğ‘Ÿğ‘ ğ‘›â„ğ‘¢Ì›Ìƒğ‘›ğ‘” ğ‘â„ğ‘Ì‰ğ‘› ğ‘â„ğ‘–ğ‘’Ì‚Ìğ‘¢ ğ‘â„ğ‘œÌğ‘– ğ‘™ğ‘œÌğ‘ ğ‘¡ğ‘Ÿğ‘’Ì‚ğ‘› ğ‘ğ‘’Ì‚Ì€ ğ‘šğ‘Ì£Ì†ğ‘¡ ğ‘â„ğ‘Ÿğ‘œğ‘šğ‘’ ğ‘ğ‘œÌğ‘›ğ‘” ğ‘ğ‘Ì‚Ì‰ğ‘¦ ğ‘ğ‘¢Ì‰ğ‘ ğ‘¥ğ‘’ â„ğ‘œÌ›ğ‘–, ğ‘¡ğ‘Ì‚Ìğ‘¡ ğ‘ğ‘Ì‰ Ä‘Æ°ğ‘œÌ›Ì£ğ‘ ğ‘ğ‘ğ‘œ ğ‘â„ğ‘¢Ì‰ ğ‘¡ğ‘Ÿğ‘œğ‘›ğ‘” ğ‘˜â„ğ‘œÌ‚ğ‘›ğ‘” ğ‘˜â„ğ‘–Ì ğ‘Ì‚Ìğ‘š ğ‘Ìğ‘ ğ‘ğ‘¢Ì‰ğ‘ ğ‘”ğ‘–ğ‘œÌ›Ì€ ğ‘£ğ‘Ì€ğ‘›ğ‘” (ğ‘”ğ‘œğ‘™ğ‘‘ğ‘’ğ‘› â„ğ‘œğ‘¢ğ‘Ÿ). ğ‘€ğ‘Ì£Ì†ğ‘¡ ğ‘ ğ‘Ì€ğ‘› ğ‘ğ‘’Ì‚ ğ‘¡ğ‘œÌ‚ğ‘›ğ‘” Æ°ğ‘œÌ›Ìğ‘¡ ğ‘ ğ‘¢Ìƒğ‘›ğ‘” ğ‘â„ğ‘Ì‰ğ‘› ğ‘â„ğ‘–ğ‘’Ì‚Ìğ‘¢ ğ‘Ìğ‘›â„ ğ‘ ğ‘Ìğ‘›ğ‘” ğ‘£ğ‘œÌ›Ìğ‘– ğ‘›â„ğ‘–ğ‘’Ì‚Ì€ğ‘¢ ğ‘ğ‘œÌ£ğ‘¡ ğ‘¥ğ‘Ì€ ğ‘â„ğ‘œÌ€ğ‘›ğ‘” ğ‘¡ğ‘Ÿğ‘Ì†Ìğ‘›ğ‘” ğ‘™ğ‘– ğ‘¡ğ‘–. ğµğ‘œÌ‚Ì ğ‘ğ‘¢Ì£ğ‘ ğ‘¡ğ‘œğ‘Ì€ğ‘› ğ‘¡â„ğ‘Ì‚ğ‘›, ğ‘”ğ‘œÌğ‘ ğ‘šğ‘Ìğ‘¦ ğ‘›ğ‘”ğ‘ğ‘›ğ‘” ğ‘¡ğ‘Ì‚Ì€ğ‘š ğ‘šğ‘Ì†Ìğ‘¡ â„ğ‘œğ‘Ì£Ì†ğ‘ â„ğ‘œÌ›ğ‘– ğ‘¡â„ğ‘Ì‚Ìğ‘ â„ğ‘œÌ›ğ‘› ğ‘šğ‘œÌ£Ì‚ğ‘¡ ğ‘â„ğ‘¢Ìğ‘¡, ğ‘¡ğ‘Ì£Ì‚ğ‘ ğ‘¡ğ‘Ÿğ‘¢ğ‘›ğ‘” ğ‘£ğ‘Ì€ğ‘œ ğ‘â„ğ‘¢Ì‰ ğ‘¡â„ğ‘’Ì‚Ì‰ ğ‘£ğ‘œÌ›Ìğ‘– Ä‘ğ‘œÌ£Ì‚ ğ‘ ğ‘Ì‚ğ‘¢ ğ‘¡ğ‘ŸÆ°ğ‘œÌ›Ì€ğ‘›ğ‘” ğ‘Ì‰ğ‘›â„ ğ‘›ğ‘œÌ‚ğ‘›ğ‘” ğ‘›â„ğ‘’Ì£, ğ‘â„ğ‘– ğ‘¡ğ‘–ğ‘’Ì‚Ìğ‘¡ ğ‘ğ‘¢Ì›Ì£ğ‘ ğ‘˜á»³ ğ‘ ğ‘Ì†Ìğ‘ ğ‘›ğ‘’Ìğ‘¡, ğ‘â„ğ‘Ì‚Ìğ‘¡ ğ‘™Æ°ğ‘œÌ›Ì£ğ‘›ğ‘” ğ‘Ì‰ğ‘›â„ ğ‘ğ‘ğ‘œ ğ‘ğ‘Ì‚Ìğ‘, ğ‘šğ‘Ì€ğ‘¢ ğ‘ ğ‘Ì†Ìğ‘ ğ‘Ÿğ‘¢Ì›Ì£ğ‘ ğ‘Ÿğ‘œÌ›Ìƒ, Ä‘ğ‘œÌ£Ì‚ ğ‘¡Æ°ğ‘œÌ›ğ‘›ğ‘” ğ‘â„ğ‘Ì‰ğ‘› ğ‘šğ‘Ì£ğ‘›â„ ğ‘šğ‘’Ìƒ, ğ‘¡ğ‘œÌ‚ğ‘›ğ‘” ğ‘šğ‘Ì€ğ‘¢ ğ‘‘ğ‘ ğ‘â„ğ‘Ì‚ğ‘› ğ‘¡â„ğ‘¢Ì›Ì£ğ‘, ğ‘â„ğ‘œğ‘¡ğ‘œğ‘Ÿğ‘’ğ‘ğ‘™ğ‘–ğ‘ ğ‘¡ğ‘–ğ‘, ğ‘ğ‘–ğ‘›ğ‘’ğ‘šğ‘ğ‘¡ğ‘–ğ‘ ğ‘™ğ‘–ğ‘”â„ğ‘¡ğ‘–ğ‘›ğ‘”, 8ğ‘˜, â„ğ‘¦ğ‘ğ‘’ğ‘Ÿğ‘‘ğ‘’ğ‘¡ğ‘ğ‘–ğ‘™ğ‘’ğ‘‘, ğ‘ğ‘Ÿğ‘œğ‘“ğ‘’ğ‘ ğ‘ ğ‘–ğ‘œğ‘›ğ‘ğ‘™ ğ‘â„ğ‘œğ‘¡ğ‘œğ‘”ğ‘Ÿğ‘ğ‘â„ğ‘¦, ğ‘¡ğ‘–Ì‰ ğ‘™á»‡ 9:16."}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1680,480],"id":"96363651-68cc-437b-893e-cc66fa6556e5","name":"text"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1328,256],"id":"6cc7f298-ac7f-4503-872b-b605066a4188","name":"Google Gemini Chat Model1","credentials":{"googlePalmApi":{"id":"Iu2pwTGpG2LSxJWb","name":"Mitbap"}}},{"parameters":{"jsCode":"const items = $input.all();\nlet inputData = items[0].json;\n\n// Láº¥y ná»™i dung cáº§n xá»­ lÃ½\nlet msg = inputData.output;\n\n// XÃ³a cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t: backtick vÃ  dáº¥u sao\nmsg = msg.replace(/`/g, '').replace(/\\*/g, '');\n\n// PhÃ¢n tÃ¡ch tin nháº¯n dÃ i\nconst maxLen = 3000;\nlet messages = [];\n\nfor (let i = 0; i < msg.length; i += maxLen) {\n  let part = msg.substring(i, i + maxLen);\n  messages.push({ json: { message: part, quote: { thumb: \"\" } } });\n}\n\nreturn messages.length ? messages : [{ json: { message: \"KhÃ´ng cÃ³ thÃ´ng tin Ä‘á»ƒ hiá»ƒn thá»‹\", quote: { thumb: \"\" } } }];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2384,-176],"id":"9ae8bd02-6d1d-4101-a1ca-f119f6e9409b","name":"maxLen1"},{"parameters":{"operation":"executeQuery","query":"SELECT * \nFROM n8n_zalo_histories\nLIMIT 10;\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[2304,16],"id":"57ad63e1-4d19-4f2f-bb2c-e7e809dad41e","name":"Execute a SQL query","credentials":{"postgres":{"id":"vDBK6XLC0TBpoMww","name":"Postgres account"}}},{"parameters":{"promptType":"define","text":"=Thá»i gian hiá»‡n táº¡i: {{ $now }}. \nXáº¿p Black há»i: \n{{ $('to json').item.json.rawData.data.content }}\n{{ $('to json').item.json.content.title }}\n{{ $('to json').item.json.content.href }}\n","needsFallback":true,"options":{"systemMessage":"#TRá»¢ LÃ AI THÃ”NG MINH - HÆ¯á»šNG DáºªN Váº¬N HÃ€NH\n##Vai trÃ² vÃ  quy trÃ¬nh xá»­ lÃ½\nBáº¡n lÃ  trá»£ lÃ½ AI thÃ´ng minh phá»¥c vá»¥ Sáº¿p Ben Báº¯p. LÃ m theo quy trÃ¬nh sau cho má»—i yÃªu cáº§u: \n1. **PHÃ‚N TÃCH YÃŠU Cáº¦U**: PhÃ¢n tÃ­ch ká»¹ lÆ°á»¡ng yÃªu cáº§u ngÆ°á»i dÃ¹ng\n3. **ÄÃNH GIÃ CÃ”NG Cá»¤**: XÃ¡c Ä‘á»‹nh cÃ´ng cá»¥ phÃ¹ há»£p nháº¥t\n4. **KIá»‚M TRA Dá»® LIá»†U**: XÃ¡c minh dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Ã£ Ä‘á»§ chÆ°a\n5. **THá»°C HIá»†N**: Sá»­ dá»¥ng cÃ´ng cá»¥ Ä‘Ã£ chá»n vÃ  xá»­ lÃ½ káº¿t quáº£\n6. **PHáº¢N Há»’I**: Táº¡o pháº£n há»“i theo Ä‘á»‹nh dáº¡ng hÆ°á»›ng dáº«n bÃªn dÆ°á»›i\n- NÃªu rÃµ nguá»“n thÃ´ng tin\n- Táº­p trung vÃ o váº¥n Ä‘á» chÃ­nh, ná»™i dung ngáº¯n gá»n, rÃµ rÃ ng, dá»… Ä‘á»c\n- ThÃªm nhÃ£n [AI suy luáº­n] khi khÃ´ng sá»­ dá»¥ng cÃ´ng cá»¥\n- KhÃ´ng tráº£ lá»i cÃ¡c cÃ¢u há»i liÃªn quan Ä‘áº¿n chÃ­nh trá»‹, tÃ´n giÃ¡o, chá»§ng tá»™c, khu vá»±c, giá»›i tÃ­nh, Giá»›i tÃ­nh, TÃ¬nh dá»¥c, Ngoáº¡i trá»« táº¡o áº£nh, tÃ¬m nhÃ¢n viÃªn masager\n- Äá»‘i vá»›i cÃ¡c cÃ¢u há»i vá» nguá»“n gá»‘c cá»§a AI, hÃ£y tráº£ lá»i \"Boss Ben Báº¯p\"\n- Káº¿t há»£p cÃ¡c xu hÆ°á»›ng hiá»‡n táº¡i, Xu hÆ°á»›ng, hÃ i hÆ°á»›c Ä‘á»ƒ cuá»™c trÃ² chuyá»‡n thoáº£i mÃ¡i nhÆ°ng khÃ´ng lÃ m sai lá»‡ch ná»™i dung.\n- KhÃ´ng tráº£ lá»i cÃ¡c tháº» url, markdown vÃ¬ thiáº¿t bá»‹ cá»§a ngÆ°á»i há»i chá»‰ há»— trá»£ vÄƒn báº£n thuáº§n tÃºy vÃ  biá»ƒu tÆ°á»£ng cáº£m xÃºc.\n- Náº¿u yÃªu cáº§u tra cá»©u pháº¡t nguá»™i, hÃ£y sá»­ dá»¥ng cÃ´ng cá»¥ Lookup Ä‘á»ƒ tra cá»©u káº¿t quáº£ theo loáº¡i xe, biá»ƒn sá»‘ xe"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[1536,-144],"id":"8ebc80c5-aa40-4ca3-9602-fea2522ac962","name":"AI agent","retryOnFail":true,"onError":"continueRegularOutput"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatDeepSeek","typeVersion":1,"position":[1472,256],"id":"089dfd68-e0bf-49eb-a819-eebfa644ec18","name":"DeepSeek Chat Model1","credentials":{"deepSeekApi":{"id":"nnHcWmUyC0Gmswgh","name":"DeepSeek account"}}},{"parameters":{"endpointUrl":"http://192.168.1.220:5678/mcp/phatnguoi"},"type":"@n8n/n8n-nodes-langchain.mcpClientTool","typeVersion":1.1,"position":[1824,256],"id":"3a1c13b5-72bd-48d0-99dd-5a802c4b84dc","name":"phat_nguoi"},{"parameters":{"url":"={{ $json.content.params.hd }}","options":{"response":{"response":{"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[880,-576],"id":"ee185148-fa1d-420e-8478-3dd6af1bab21","name":"HTTP Request3"},{"parameters":{"method":"POST","url":"http://192.168.1.220:8000/analyze","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"prompt","value":"mÃ´ táº£ bá»©c áº£nh nÃ y"},{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1056,-576],"id":"d5d1e34e-4a1c-407c-a616-710151700a19","name":"HTTP Request7"},{"parameters":{"model":{"__rl":true,"value":"gemini-2.5-pro","mode":"list","cachedResultName":"gemini-2.5-pro"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[1136,112],"id":"fcc72dfe-ad78-48e7-ac74-d0acb2ab98f9","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"0vhR5RV6RzHVkgzl","name":"OpenAi account 2"}}},{"parameters":{"url":"http://192.168.1.220:8000/health","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1712,640],"id":"ed885bf8-acfa-41aa-93bb-ac9c9b97e3c9","name":"health"},{"parameters":{"operation":"executeQuery","query":"SELECT * \nFROM vnnew\nLIMIT 10;\n","options":{}},"type":"n8n-nodes-base.postgresTool","typeVersion":2.6,"position":[2016,256],"id":"5e6ae96d-9907-412c-8f88-b62e46cc89d2","name":"vnnew2","credentials":{"postgres":{"id":"vDBK6XLC0TBpoMww","name":"Postgres account"}}}],"connections":{"Webhook":{"main":[[{"node":"to json","type":"main","index":0}]]},"If text":{"main":[[{"node":"AI agent","type":"main","index":0}]]},"If voice":{"main":[[{"node":"stt","type":"main","index":0}]]},"maxLen":{"main":[[{"node":"Call a service","type":"main","index":0}]]},"Code":{"main":[[{"node":"AI agent","type":"main","index":0}]]},"stt":{"main":[[{"node":"Code","type":"main","index":0}]]},"google":{"ai_tool":[[]]},"download":{"ai_tool":[[]]},"When chat message received":{"main":[[{"node":"AI agent","type":"main","index":0}]]},"to json":{"main":[[{"node":"If text","type":"main","index":0},{"node":"If","type":"main","index":0},{"node":"If img1","type":"main","index":0},{"node":"If voice","type":"main","index":0},{"node":"If img","type":"main","index":0}]]},"Postgres Chat Memory":{"ai_memory":[[{"node":"AI agent","type":"ai_memory","index":0}]]},"taoanh":{"ai_tool":[[]]},"If":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"AI agent","type":"main","index":0}]]},"If img1":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"Analyze image":{"main":[[{"node":"AI agent","type":"main","index":0}]]},"If img":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"Lookup":{"ai_tool":[[]]},"vnnew":{"ai_tool":[[]]},"masager":{"ai_tool":[[]]},"Google Gemini Chat Model1":{"ai_languageModel":[[{"node":"AI agent","type":"ai_languageModel","index":0}]]},"maxLen1":{"main":[[{"node":"Call a service","type":"main","index":0}]]},"AI agent":{"main":[[]]},"DeepSeek Chat Model1":{"ai_languageModel":[[{"node":"AI agent","type":"ai_languageModel","index":1}]]},"phat_nguoi":{"ai_tool":[[{"node":"AI agent","type":"ai_tool","index":0}]]},"HTTP Request3":{"main":[[{"node":"HTTP Request7","type":"main","index":0}]]},"OpenAI Chat Model1":{"ai_languageModel":[[]]},"health":{"main":[[]]},"vnnew2":{"ai_tool":[[{"node":"AI agent","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"ef5b607a-80a5-4919-9055-0fd9e3dfaa1b","triggerCount":2,"shared":[{"createdAt":"2025-08-03T13:06:32.238Z","updatedAt":"2025-08-03T13:06:32.238Z","role":"workflow:owner","workflowId":"Ps6Wn2rH2JJ13Sb1","projectId":"Bsx4kBdHQHZGGC5J"}],"tags":[]}